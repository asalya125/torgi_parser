

# –ò–ú–ü–û–†–¢ –ë–ò–ë–õ–ò–û–¢–ï–ö
from bs4 import BeautifulSoup  # –î–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
import requests                 # –î–ª—è HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –∫ —Å–∞–π—Ç—É
import re                      # –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏

# =============================================================================
# –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–†–ï–û–ë–†–ê–ó–û–í–ê–ù–ò–Ø –¶–ï–ù
# =============================================================================
def parse_price(price_text):
    """
    –ü–†–ï–û–ë–†–ê–ó–£–ï–¢ –¢–ï–ö–°–¢–û–í–û–ï –ü–†–ï–î–°–¢–ê–í–õ–ï–ù–ò–ï –¶–ï–ù–´ –í –ß–ò–°–õ–û
    
    –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
        price_text (str): –¢–µ–∫—Å—Ç —Ü–µ–Ω—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä "2 662 880.00 —Ä—É–±."
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
        float: –ß–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–Ω—ã
    
    –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è:
        "2 662 880.00 —Ä—É–±." -> 2662880.0
        "535 500.00 —Ä—É–±."   -> 535500.0
    """
    # –ï–°–õ–ò –¢–ï–ö–°–¢ –ü–£–°–¢–û–ô, –í–û–ó–í–†–ê–©–ê–ï–ú 0
    if not price_text:
        return 0
    
    # –®–ê–ì 1: –ó–ê–ú–ï–ù–Ø–ï–ú –ó–ê–ü–Ø–¢–´–ï –ù–ê –¢–û–ß–ö–ò –î–õ–Ø –£–ù–ò–§–ò–ö–ê–¶–ò–ò –†–ê–ó–î–ï–õ–ò–¢–ï–õ–ï–ô
    # –≠—Ç–æ –Ω—É–∂–Ω–æ –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∞—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–∞–∑–Ω—ã–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏:
    # - –†–æ—Å—Å–∏—è: 1 500 000,50 (–ø—Ä–æ–±–µ–ª—ã —Ç—ã—Å—è—á, –∑–∞–ø—è—Ç–∞—è –¥–µ—Å—è—Ç–∏—á–Ω—ã—Ö)
    # - –°–®–ê: 1,500,000.50 (–∑–∞–ø—è—Ç—ã–µ —Ç—ã—Å—è—á, —Ç–æ—á–∫–∞ –¥–µ—Å—è—Ç–∏—á–Ω—ã—Ö)
    unified_text = price_text.replace(',', '.')
    
    # –®–ê–ì 2: –£–î–ê–õ–Ø–ï–ú –í–°–ï –°–ò–ú–í–û–õ–´ –ö–†–û–ú–ï –¶–ò–§–† –ò –¢–û–ß–ï–ö
    # re.sub(r'[^\d.]', '', text) - –û–°–ù–û–í–ù–ê–Ø –ú–ê–ì–ò–Ø –†–ï–ì–£–õ–Ø–†–ù–´–• –í–´–†–ê–ñ–ï–ù–ò–ô!
    #
    # –†–ê–ó–ë–ò–†–ê–ï–ú –ü–û –ß–ê–°–¢–Ø–ú:
    # re.sub() - —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–º–µ–Ω—ã –ø–æ —à–∞–±–ª–æ–Ω—É
    # r'[^\d.]' - —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ (—à–∞–±–ª–æ–Ω –ø–æ–∏—Å–∫–∞)
    # '' - –Ω–∞ —á—Ç–æ –∑–∞–º–µ–Ω—è–µ–º (–Ω–∞ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É, —Ç.–µ. —É–¥–∞–ª—è–µ–º)
    # unified_text - —Ç–µ–∫—Å—Ç –≤ –∫–æ—Ç–æ—Ä–æ–º –∏—â–µ–º
    #
    # –†–ê–ó–ë–û–† –†–ï–ì–£–õ–Ø–†–ù–û–ì–û –í–´–†–ê–ñ–ï–ù–ò–Ø r'[^\d.]':
    # [ ]    - –Ω–∞–±–æ—Ä —Å–∏–º–≤–æ–ª–æ–≤
    # ^      - –û–¢–†–ò–¶–ê–ù–ò–ï (–≤–Ω—É—Ç—Ä–∏ [ ] –æ–∑–Ω–∞—á–∞–µ—Ç "–∫—Ä–æ–º–µ —ç—Ç–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤")
    # \d     - –ª—é–±–∞—è —Ü–∏—Ñ—Ä–∞ (0-9)
    # .      - —Å–∏–º–≤–æ–ª —Ç–æ—á–∫–∏
    # –í–ú–ï–°–¢–ï: [^\d.] –æ–∑–Ω–∞—á–∞–µ—Ç "–õ–Æ–ë–û–ô –°–ò–ú–í–û–õ –ö–†–û–ú–ï –¶–ò–§–† –ò –¢–û–ß–ö–ò"
    #
    # –ü–†–ò–ú–ï–†–´:
    # "2 662 880.00 —Ä—É–±." -> "2662880.00" (—É–¥–∞–ª–∏–ª–∏—Å—å –ø—Ä–æ–±–µ–ª—ã –∏ "—Ä—É–±.")
    # "1,500,000.50 ‚ÇΩ"    -> "1500000.50" (—É–¥–∞–ª–∏–ª–∏—Å—å –∑–∞–ø—è—Ç—ã–µ –∏ —Å–∏–º–≤–æ–ª —Ä—É–±–ª—è)
    clean_text = re.sub(r'[^\d.]', '', unified_text)
    
    # –®–ê–ì 3: –û–ë–†–ê–ë–ê–¢–´–í–ê–ï–ú –°–õ–£–ß–ê–ô –° –ù–ï–°–ö–û–õ–¨–ö–ò–ú–ò –¢–û–ß–ö–ê–ú–ò
    # –ò–Ω–æ–≥–¥–∞ –≤ —á–∏—Å–ª–∞—Ö —Ç–æ—á–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ —Ç—ã—Å—è—á: "1.500.000,50"
    # –ü–æ—Å–ª–µ –Ω–∞—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å—Å—è "1.500.000.50" - –º–Ω–æ–≥–æ —Ç–æ—á–µ–∫!
    # –ù–∞–º –Ω—É–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –û–î–ù–£ —Ç–æ—á–∫—É –∫–∞–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –¥–µ—Å—è—Ç–∏—á–Ω—ã—Ö
    parts = clean_text.split('.')  # –†–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –ø–æ —Ç–æ—á–∫–∞–º
    
    if len(parts) > 1:
        # –ï–°–õ–ò –ï–°–¢–¨ –•–û–¢–Ø –ë–´ –û–î–ù–ê –¢–û–ß–ö–ê:
        # parts[0] - —á–∞—Å—Ç—å –¥–æ –ø–µ—Ä–≤–æ–π —Ç–æ—á–∫–∏ (—Ü–µ–ª–∞—è —á–∞—Å—Ç—å)
        # parts[1:] - –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —á–∞—Å—Ç–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π —Ç–æ—á–∫–∏
        # ''.join(parts[1:]) - –æ–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π —Ç–æ—á–∫–∏ –±–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π
        clean_text = parts[0] + '.' + ''.join(parts[1:])
    
    # –®–ê–ì 4: –ü–†–ï–û–ë–†–ê–ó–£–ï–ú –í –ß–ò–°–õ–û
    try:
        return float(clean_text) if clean_text else 0
    except ValueError:
        # –ï–°–õ–ò –ü–†–ï–û–ë–†–ê–ó–û–í–ê–ù–ò–ï –ù–ï –£–î–ê–õ–û–°–¨ (—Ä–µ–¥–∫–∏–π —Å–ª—É—á–∞–π)
        print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ü–µ–Ω—ã: '{price_text}' -> '{clean_text}'")
        return 0

# =============================================================================
# –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–†–û–ì–†–ê–ú–ú–´
# =============================================================================
def main():
    """
    –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–†–û–ì–†–ê–ú–ú–´
    –£–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º –ø–∞—Ä—Å–∏–Ω–≥–∞: –∑–∞–≥—Ä—É–∑–∫–∞, –∞–Ω–∞–ª–∏–∑, –≤—ã–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö
    """
    # –í–´–í–û–î –ó–ê–ì–û–õ–û–í–ö–ê –ü–†–û–ì–†–ê–ú–ú–´
    print("üîç –ü–ê–†–°–ï–† –†–ï–ê–õ–¨–ù–û–ì–û –°–ê–ô–¢–ê Torgi.org")
    
    # –°–û–ó–î–ê–ï–ú –†–ê–ó–î–ï–õ–ò–¢–ï–õ–¨ –ò–ó 50 –°–ò–ú–í–û–õ–û–í '=' –î–õ–Ø –í–ò–ó–£–ê–õ–¨–ù–û–ì–û –û–¢–î–ï–õ–ï–ù–ò–Ø
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º 50 —Å–∏–º–≤–æ–ª–æ–≤ –≤–º–µ—Å—Ç–æ 60, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –≤ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏
    # —Ä–∞–∑–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º—ã
    print("=" * 50)
    
    # –í–´–ó–û–í –§–£–ù–ö–¶–ò–ò-–î–ï–ú–û–ù–°–¢–†–ê–¶–ò–ò –†–ï–ì–£–õ–Ø–†–ù–´–• –í–´–†–ê–ñ–ï–ù–ò–ô
    # –≠–¢–£ –°–¢–†–û–ö–£ –ú–û–ñ–ù–û –ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–¢–¨, –ï–°–õ–ò –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ù–ï –ù–£–ñ–ù–ê:
    # demonstrate_regex_examples()
    demonstrate_regex_examples()
    
    # URL –¶–ï–õ–ï–í–û–ì–û –°–ê–ô–¢–ê –° –õ–û–¢–ê–ú–ò –¢–û–†–ì–û–í
    url = "https://torgi.org/index.php?class=Auction&action=List&mod=Open&AuctionType=All"
    
    try:
        # –ù–ê–°–¢–†–û–ô–ö–ò HTTP-–ó–ê–ü–†–û–°–ê
        headers = {
            'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36'
        }
        # User-Agent –∏–º–∏—Ç–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä - –±–µ–∑ —ç—Ç–æ–≥–æ —Å–∞–π—Ç –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å
        # timeout=10 —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤ 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
        
        # –í–´–ü–û–õ–ù–Ø–ï–ú HTTP-–ó–ê–ü–†–û–°
        response = requests.get(url, headers=headers, timeout=10)
        response.raise_for_status()  # –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞ (—Å—Ç–∞—Ç—É—Å 200)
        
        # –°–û–ó–î–ê–ï–ú –û–ë–™–ï–ö–¢ BeautifulSoup –î–õ–Ø –ü–ê–†–°–ò–ù–ì–ê HTML
        soup = BeautifulSoup(response.text, 'html.parser')
        print("‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!")
        
        # –°–ü–ò–°–û–ö –î–õ–Ø –•–†–ê–ù–ï–ù–ò–Ø –ù–ê–ô–î–ï–ù–ù–´–• –õ–û–¢–û–í
        lots = []
        
        # –≠–¢–ê–ü 1: –ü–û–ò–°–ö –ò –ê–ù–ê–õ–ò–ó –¢–ê–ë–õ–ò–¶
        print("üîç –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã...")
        
        # –ù–∞—Ö–æ–¥–∏–º –í–°–ï —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        tables = soup.find_all('table')
        print(f"üìä –ù–∞–π–¥–µ–Ω–æ —Ç–∞–±–ª–∏—Ü: {len(tables)}")
        
        # –û–±—ã—á–Ω–æ –¥–∞–Ω–Ω—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤–æ –í–¢–û–†–û–ô —Ç–∞–±–ª–∏—Ü–µ (–∏–Ω–¥–µ–∫—Å 1)
        if len(tables) > 1:
            main_table = tables[1]  # –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –ª–æ—Ç–∞–º–∏
            rows = main_table.find_all('tr')  # –í—Å–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
            print(f"üìã –ù–∞–π–¥–µ–Ω–æ —Å—Ç—Ä–æ–∫ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ: {len(rows)}")
            
            # –ü–†–û–•–û–î–ò–ú –ü–û –ö–ê–ñ–î–û–ô –°–¢–†–û–ö–ï –¢–ê–ë–õ–ò–¶–´
            for i, row in enumerate(rows):
                # –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ —è—á–µ–π–∫–∏ –≤ —Å—Ç—Ä–æ–∫–µ (–∫–∞–∫ td, —Ç–∞–∫ –∏ th)
                cells = row.find_all(['td', 'th'])
                
                # –§–ò–õ–¨–¢–†: —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏ —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —è—á–µ–µ–∫
                # (–∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ–±—ã—á–Ω–æ –∏–º–µ—é—Ç –º–µ–Ω—å—à–µ —è—á–µ–µ–∫, –¥–∞–Ω–Ω—ã–µ - –±–æ–ª—å—à–µ)
                if len(cells) > 5:
                    # –ü–ï–†–ï–ú–ï–ù–ù–´–ï –î–õ–Ø –•–†–ê–ù–ï–ù–ò–Ø –î–ê–ù–ù–´–• –û –õ–û–¢–ï
                    price_text = ""  # –¢–µ–∫—Å—Ç —Ü–µ–Ω—ã
                    name = ""        # –ù–∞–∑–≤–∞–Ω–∏–µ –ª–æ—Ç–∞
                    region = ""      # –†–µ–≥–∏–æ–Ω
                    link = ""        # –°—Å—ã–ª–∫–∞ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
                    
                    # –ê–ù–ê–õ–ò–ó –ö–ê–ñ–î–û–ô –Ø–ß–ï–ô–ö–ò –í –°–¢–†–û–ö–ï
                    for cell in cells:
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º –∏ –æ—á–∏—â–∞–µ–º —Ç–µ–∫—Å—Ç —è—á–µ–π–∫–∏
                        cell_text = cell.get_text(strip=True)
                        
                        # –ü–û–ò–°–ö –¶–ï–ù–´: –∏—â–µ–º —Ç–µ–∫—Å—Ç —Å —à–∞–±–ª–æ–Ω–æ–º "—á–∏—Å–ª–∞ —Ä—É–±."
                        if re.search(r'\d[\d\s]*\.?\d*\.?\d*\s*—Ä—É–±', cell_text, re.I):
                            price_text = cell_text
                        
                        # –ü–û–ò–°–ö –ù–ê–ó–í–ê–ù–ò–Ø: –¥–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –±–µ–∑ –¥–∞—Ç –∏ –Ω–µ —è–≤–ª—è—é—â–∏–π—Å—è —Ü–µ–Ω–æ–π
                        elif (len(cell_text) > 30 and 
                              not price_text and 
                              not re.search(r'\d{2}-\d{2}-\d{4}', cell_text)):
                            name = cell_text
                            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∏—â–µ–º —Å—Å—ã–ª–∫—É –≤ —ç—Ç–æ–π —è—á–µ–π–∫–µ
                            link_elem = cell.find('a')
                            if link_elem:
                                link_href = link_elem.get('href', '')
                                # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –≤ –∞–±—Å–æ–ª—é—Ç–Ω—É—é
                                if link_href.startswith('/'):
                                    link = 'https://torgi.org' + link_href
                                else:
                                    link = link_href
                        
                        # –ü–û–ò–°–ö –†–ï–ì–ò–û–ù–ê: –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ä–µ–≥–∏–æ–Ω–∞
                        elif (len(cell_text) < 30 and 
                              re.search(r'[–ê-–Ø][–∞-—è]+\s*–æ–±–ª|–≥\.|–†–µ—Å–ø', cell_text)):
                            region = cell_text
                    
                    # –ü–†–û–í–ï–†–ö–ê: –µ—Å–ª–∏ –Ω–∞—à–ª–∏ –∏ —Ü–µ–Ω—É –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ - —ç—Ç–æ –≤–∞–ª–∏–¥–Ω—ã–π –ª–æ—Ç
                    if price_text and name:
                        price = parse_price(price_text)  # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ü–µ–Ω—É –≤ —á–∏—Å–ª–æ
                        
                        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: —Ü–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–π
                        if price > 0:
                            # –°–û–ó–î–ê–ï–ú –°–õ–û–í–ê–†–¨ –° –î–ê–ù–ù–´–ú–ò –õ–û–¢–ê
                            lot = {
                                'name': name,           # –ù–∞–∑–≤–∞–Ω–∏–µ
                                'region': region,       # –†–µ–≥–∏–æ–Ω
                                'price': price,         # –¶–µ–Ω–∞ (—á–∏—Å–ª–æ)
                                'link': link,           # –°—Å—ã–ª–∫–∞
                                'price_text': price_text  # –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç —Ü–µ–Ω—ã
                            }
                            
                            # –ü–†–û–í–ï–†–ö–ê –ù–ê –î–£–ë–õ–ò–ö–ê–¢–´: –∏–∑–±–µ–≥–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
                            if not any(l['name'] == name and l['price'] == price for l in lots):
                                lots.append(lot)
                                # –í—ã–≤–æ–¥–∏–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–∞—Ä—Å–∏–Ω–≥–∞
                                print(f"‚úÖ –õ–æ—Ç {len(lots)}: {price:,.2f} —Ä—É–± - {name[:50]}...")
        
        # –≠–¢–ê–ü 2: –í–´–í–û–î –†–ï–ó–£–õ–¨–¢–ê–¢–û–í
        if lots:
            # –°–û–†–¢–ò–†–û–í–ö–ê –õ–û–¢–û–í –ü–û –£–ë–´–í–ê–ù–ò–Æ –¶–ï–ù–´
            sorted_lots = sorted(lots, key=lambda x: x['price'], reverse=True)
            
            # –í–´–í–û–î –û–¢–°–û–†–¢–ò–†–û–í–ê–ù–ù–´–• –†–ï–ó–£–õ–¨–¢–ê–¢–û–í
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –∏–∑ 100 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è —à–∏—Ä–æ–∫–∏—Ö —Ç–∞–±–ª–∏—Ü
            print(f"\nüìä –†–ï–ê–õ–¨–ù–´–ï –õ–û–¢–´ –° –°–ê–ô–¢–ê: –ù–∞–π–¥–µ–Ω–æ {len(sorted_lots)} –ª–æ—Ç–æ–≤")
            print("=" * 100)
            
            for i, lot in enumerate(sorted_lots, 1):
                # –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ù–´–ô –í–´–í–û–î –° –í–´–†–ê–í–ù–ò–í–ê–ù–ò–ï–ú
                print(f"{i:2d}. üí∞ {lot['price']:12,.2f} —Ä—É–±")
                
                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å)
                if lot['region']:
                    print(f"    üìç {lot['region']}")
                print(f"    üè∑  {lot['name'][:80]}...")
                if lot['link']:
                    print(f"    üîó {lot['link']}")
                
                # –†–ê–ó–î–ï–õ–ò–¢–ï–õ–¨ –ú–ï–ñ–î–£ –õ–û–¢–ê–ú–ò –ò–ó 100 –°–ò–ú–í–û–õ–û–í '-'
                print("-" * 100)
            
            # –≠–¢–ê–ü 3: –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –ü–û –¶–ï–ù–ï
            print("\nüéØ –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –ü–û –¶–ï–ù–ï")
            try:
                # –ó–ê–ü–†–ê–®–ò–í–ê–ï–ú –î–ò–ê–ü–ê–ó–û–ù –¶–ï–ù –û–¢ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
                min_input = input("–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ (—Ä—É–±, Enter - –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å): ").strip()
                max_input = input("–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ (—Ä—É–±, Enter - –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å): ").strip()
                
                # –ü–†–ï–û–ë–†–ê–ó–£–ï–ú –í–í–û–î –í –ß–ò–°–õ–ê (–µ—Å–ª–∏ –Ω–µ –ø—É—Å—Ç–æ)
                min_price = float(min_input) if min_input else None
                max_price = float(max_input) if max_input else None
                
                # –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –õ–û–¢–û–í –ü–û –î–ò–ê–ü–ê–ó–û–ù–£
                filtered_lots = []
                for lot in sorted_lots:
                    if min_price and lot['price'] < min_price:
                        continue
                    if max_price and lot['price'] > max_price:
                        continue
                    filtered_lots.append(lot)
                
                # –í–´–í–û–î –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –§–ò–õ–¨–¢–†–ê–¶–ò–ò
                if filtered_lots:
                    print(f"\nüîç –û–¢–§–ò–õ–¨–¢–†–û–í–ê–ù–û –õ–û–¢–û–í: {len(filtered_lots)}")
                    for i, lot in enumerate(filtered_lots, 1):
                        print(f"{i}. {lot['price']:,.2f} —Ä—É–± - {lot['name'][:70]}...")
                else:
                    print("‚ùå –ù–µ—Ç –ª–æ—Ç–æ–≤ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ —Ü–µ–Ω")
                    
            except ValueError:
                print("‚ùå –û—à–∏–±–∫–∞ –≤–≤–æ–¥–∞ —Ü–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á–∏—Å–ª–∞ –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø–æ–ª–µ –ø—É—Å—Ç—ã–º.")
                
        else:
            print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –ª–æ—Ç—ã –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö")
            print("üí° –í–æ–∑–º–æ–∂–Ω–æ, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∞–π—Ç–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å")
            
    except requests.exceptions.RequestException as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: {e}")
    except Exception as e:
        print(f"‚ùå –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")

# =============================================================================
# –¢–û–ß–ö–ê –í–•–û–î–ê –í –ü–†–û–ì–†–ê–ú–ú–£
# =============================================================================
if __name__ == "__main__":
    """
    –≠–¢–û–¢ –ë–õ–û–ö –í–´–ü–û–õ–ù–Ø–ï–¢–°–Ø –¢–û–õ–¨–ö–û –ü–†–ò –ü–†–Ø–ú–û–ú –ó–ê–ü–£–°–ö–ï –§–ê–ô–õ–ê,
    –ê –ù–ï –ü–†–ò –ò–ú–ü–û–†–¢–ï –ö–ê–ö –ú–û–î–£–õ–Ø
    
    –¢–∞–∫–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç:
    1. –ó–∞–ø—É—Å–∫–∞—Ç—å —Ñ–∞–π–ª –Ω–∞–ø—Ä—è–º—É—é: python parse_trades.py
    2. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –¥—Ä—É–≥–∏—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö –±–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
    """
    main()
